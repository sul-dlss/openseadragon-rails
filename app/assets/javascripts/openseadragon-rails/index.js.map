{"version":3,"file":"index.js","sources":["../../../javascript/openseadragon-rails/dom.js","../../../javascript/openseadragon-rails/rails.js"],"sourcesContent":["import OpenSeadragon from 'openseadragon'\n\n(function() {\n  let __osd_counter = 0;\n\n  function generateOsdId() {\n    __osd_counter++;\n    return \"Openseadragon\" + __osd_counter;\n  }\n\n  function openseadragon() {\n    this.forEach(function(picture) {\n      // Ensure the element is an HTMLElement\n      if (!(picture instanceof HTMLElement)) return;\n\n      picture.classList.add('openseadragon-viewer');\n\n      // Set ID if it doesn't exist\n      if (!picture.id) {\n        picture.id = generateOsdId();\n      }\n\n      // Retrieve openseadragon data attribute as JSON\n      const collectionOptions = picture.dataset.openseadragon\n        ? JSON.parse(picture.dataset.openseadragon)\n        : {};\n\n      // Find all <source> elements with media=\"openseadragon\"\n      const sources = Array.from(picture.querySelectorAll('source[media=\"openseadragon\"]'));\n\n      const tileSources = sources.map(source => {\n        const osdData = source.dataset.openseadragon;\n        return osdData ? JSON.parse(osdData) : source.getAttribute('src');\n      });\n\n      // Preserve height of the picture\n      const height = window.getComputedStyle(picture).height;\n      picture.style.height = height;\n\n      // Initialize OpenSeadragon\n      picture.osdViewer = OpenSeadragon({\n        id: picture.id,\n        ...collectionOptions,\n        tileSources: tileSources\n      });\n    });\n\n    return this;\n  }\n\n  // Attach the function to NodeList and HTMLElement prototypes for convenience\n  NodeList.prototype.openseadragon = openseadragon;\n  HTMLCollection.prototype.openseadragon = openseadragon;\n\n  // For a single HTMLElement\n  HTMLElement.prototype.openseadragon = function() {\n    return openseadragon.call([this]);\n  };\n\n})();\n","import './dom'\n\n(function() {\n  function initOpenSeadragon() {\n    document.querySelectorAll('picture[data-openseadragon]:not(:has(.openseadragon-container))').openseadragon();\n  }\n\n  if (typeof Turbo !== 'undefined') {\n    addEventListener(\"turbo:load\", () => initOpenSeadragon())\n    addEventListener(\"turbo:frame-load\", () => initOpenSeadragon())\n  } else {\n    addEventListener('load', () => initOpenSeadragon())\n  }\n})();\n"],"names":[],"mappings":";;;;;;EAEA,CAAC,WAAW;EACZ,EAAE,IAAI,aAAa,GAAG,CAAC;;EAEvB,EAAE,SAAS,aAAa,GAAG;EAC3B,IAAI,aAAa,EAAE;EACnB,IAAI,OAAO,eAAe,GAAG,aAAa;EAC1C;;EAEA,EAAE,SAAS,aAAa,GAAG;EAC3B,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,OAAO,EAAE;EACnC;EACA,MAAM,IAAI,EAAE,OAAO,YAAY,WAAW,CAAC,EAAE;;EAE7C,MAAM,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAsB,CAAC;;EAEnD;EACA,MAAM,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE;EACvB,QAAQ,OAAO,CAAC,EAAE,GAAG,aAAa,EAAE;EACpC;;EAEA;EACA,MAAM,MAAM,iBAAiB,GAAG,OAAO,CAAC,OAAO,CAAC;EAChD,UAAU,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa;EAClD,UAAU,EAAE;;EAEZ;EACA,MAAM,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,+BAA+B,CAAC,CAAC;;EAE3F,MAAM,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,IAAI;EAChD,QAAQ,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa;EACpD,QAAQ,OAAO,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC;EACzE,OAAO,CAAC;;EAER;EACA,MAAM,MAAM,MAAM,GAAG,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,MAAM;EAC5D,MAAM,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM;;EAEnC;EACA,MAAM,OAAO,CAAC,SAAS,GAAG,aAAa,CAAC;EACxC,QAAQ,EAAE,EAAE,OAAO,CAAC,EAAE;EACtB,QAAQ,GAAG,iBAAiB;EAC5B,QAAQ,WAAW,EAAE;EACrB,OAAO,CAAC;EACR,KAAK,CAAC;;EAEN,IAAI,OAAO,IAAI;EACf;;EAEA;EACA,EAAE,QAAQ,CAAC,SAAS,CAAC,aAAa,GAAG,aAAa;EAClD,EAAE,cAAc,CAAC,SAAS,CAAC,aAAa,GAAG,aAAa;;EAExD;EACA,EAAE,WAAW,CAAC,SAAS,CAAC,aAAa,GAAG,WAAW;EACnD,IAAI,OAAO,aAAa,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC;EACrC,GAAG;;EAEH,CAAC,GAAG;;ECzDJ,CAAC,WAAW;EACZ,EAAE,SAAS,iBAAiB,GAAG;EAC/B,IAAI,QAAQ,CAAC,gBAAgB,CAAC,iEAAiE,CAAC,CAAC,aAAa,EAAE;EAChH;;EAEA,EAAE,IAAI,OAAO,KAAK,KAAK,WAAW,EAAE;EACpC,IAAI,gBAAgB,CAAC,YAAY,EAAE,MAAM,iBAAiB,EAAE;EAC5D,IAAI,gBAAgB,CAAC,kBAAkB,EAAE,MAAM,iBAAiB,EAAE;EAClE,GAAG,MAAM;EACT,IAAI,gBAAgB,CAAC,MAAM,EAAE,MAAM,iBAAiB,EAAE;EACtD;EACA,CAAC,GAAG;;;;;;"}